<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Secure Checkout - VettedStay</title>
<style>
:root{--p:#7cb342;--pd:#689f38;--s:#2e7d99;--t:#2c3e50;--tl:#5a6c7d;--bg:#fff;--bgl:#f7fafc;--border:#e2e8f0;--success:#4caf50;--error:#f44336}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;color:var(--t);background:var(--bgl);line-height:1.6}
.container{max-width:900px;margin:2rem auto;padding:0 1.5rem}
.header{background:var(--bg);padding:1.5rem;text-align:center;border-radius:12px 12px 0 0;box-shadow:0 2px 8px rgba(0,0,0,.06)}
.card{background:var(--bg);border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.1);padding:2rem;margin-bottom:1.5rem}
h2{margin-bottom:1.5rem;color:var(--t)}
.form-group{margin-bottom:1.25rem}
label{display:block;margin-bottom:.5rem;font-weight:600;color:var(--t)}
input,select{width:100%;padding:.75rem;border:1px solid var(--border);border-radius:8px;font-size:1rem;transition:.3s}
input:focus,select:focus{outline:none;border-color:var(--p);box-shadow:0 0 0 3px rgba(124,179,66,.1)}
.btn{display:inline-block;padding:.875rem 2rem;border-radius:40px;font-weight:600;cursor:pointer;transition:all .3s;border:none;font-size:1rem}
.btn-primary{background:var(--p);color:#fff}
.btn-primary:hover{background:var(--pd);transform:translateY(-2px);box-shadow:0 6px 20px rgba(124,179,66,.4)}
.btn-secondary{background:var(--bg);color:var(--p);border:2px solid var(--p)}
.btn-full{width:100%}
.order-summary{background:var(--bgl);padding:1.5rem;border-radius:12px;margin:1.5rem 0}
.summary-row{display:flex;justify-content:space-between;padding:.75rem 0;border-bottom:1px solid var(--border)}
.summary-row.total{border:none;font-size:1.25rem;font-weight:700;color:var(--p);margin-top:1rem}
.payment-methods{display:grid;gap:1rem;margin:1.5rem 0}
.payment-method{padding:1.25rem;border:2px solid var(--border);border-radius:12px;cursor:pointer;transition:.3s;display:flex;align-items:center;gap:1rem}
.payment-method:hover{border-color:var(--p);background:rgba(124,179,66,.05)}
.payment-method.selected{border-color:var(--p);background:rgba(124,179,66,.08)}
.payment-method input{width:auto;margin:0}
.spinner{border:4px solid var(--bgl);border-top-color:var(--p);border-radius:50%;width:50px;height:50px;animation:spin 1s linear infinite;margin:2rem auto}
@keyframes spin{to{transform:rotate(360deg)}}
.success-icon{width:100px;height:100px;margin:0 auto 1rem;background:var(--success);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:3rem;color:#fff}
.alert{padding:1rem;border-radius:8px;margin-bottom:1rem}
.alert-success{background:#e8f5e9;color:#2e7d32;border-left:4px solid var(--success)}
.alert-error{background:#ffebee;color:#c62828;border-left:4px solid var(--error)}
@media(max-width:768px){
.container{padding:0 1rem}
.card{padding:1.5rem}
}
</style>
<!-- Meta Pixel Code -->
<script>
!function(f,b,e,v,n,t,s)
{if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};
if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];
s.parentNode.insertBefore(t,s)}(window, document,'script',
'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '1494593548316291');
fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
src="https://www.facebook.com/tr?id=1494593548316291&ev=PageView&noscript=1"
/></noscript>
<!-- End Meta Pixel Code -->
</head>
<body>

<div class="container">
<div class="header">
<h1>üîí Secure Checkout</h1>
<p style="color:var(--tl)">Complete your order securely</p>
</div>

<div id="checkoutForm">
<div class="card">
<h2>1. Order Summary</h2>
<div id="orderItems"></div>
<div class="order-summary">
<div class="summary-row">
<span>Subtotal</span>
<span id="subtotal">R0</span>
</div>
<div class="summary-row">
<span>Processing Fee</span>
<span>R15</span>
</div>
<div class="summary-row total">
<span>Total</span>
<span id="total">R15</span>
</div>
</div>
</div>

<div class="card">
<h2>2. Applicant Information</h2>
<div class="form-group">
<label>Full Name *</label>
<input type="text" id="fullName" required placeholder="John Doe">
</div>
<div class="form-group">
<label>ID Number *</label>
<input type="text" id="idNumber" required placeholder="0000000000000">
</div>
<div class="form-group">
<label>Email Address *</label>
<input type="email" id="email" required placeholder="john@vetstay.click">
</div>
<div class="form-group">
<label>Phone Number *</label>
<input type="tel" id="phone" required placeholder="0821234567">
</div>
<div class="form-group">
<label style="display:flex;align-items:start;gap:.75rem">
<input type="checkbox" id="consent" required style="width:auto;margin-top:.25rem">
<span>I have obtained consent from the applicant to conduct this screening in accordance with POPIA regulations *</span>
</label>
</div>
</div>

<div class="card">
<h2>3. Payment Method</h2>
<div class="payment-methods">
<label class="payment-method" onclick="selectPayment('card')">
<input type="radio" name="payment" value="card">
<span>üí≥ Credit/Debit Card</span>
</label>
<label class="payment-method" onclick="selectPayment('googlepay')">
<input type="radio" name="payment" value="googlepay">
<span>
<svg width="50" height="20" viewBox="0 0 50 20" style="vertical-align:middle;margin-right:.5rem">
<path fill="#4285F4" d="M22.2 9.7c0 3.1-2.4 5.4-5.4 5.4s-5.4-2.3-5.4-5.4c0-3.1 2.4-5.4 5.4-5.4s5.4 2.3 5.4 5.4zm-2.3 0c0-1.9-1.4-3.2-3.1-3.2s-3.1 1.3-3.1 3.2c0 1.9 1.4 3.2 3.1 3.2s3.1-1.3 3.1-3.2z"/>
<path fill="#EA4335" d="M32.7 9.7c0 3.1-2.4 5.4-5.4 5.4s-5.4-2.3-5.4-5.4c0-3.1 2.4-5.4 5.4-5.4s5.4 2.3 5.4 5.4zm-2.3 0c0-1.9-1.4-3.2-3.1-3.2s-3.1 1.3-3.1 3.2c0 1.9 1.4 3.2 3.1 3.2s3.1-1.3 3.1-3.2z"/>
<path fill="#FBBC04" d="M43 4.6v9.8c0 4-2.4 5.7-5.2 5.7-2.7 0-4.3-1.8-4.9-3.2l2-.8c.4 1 1.4 2.1 2.9 2.1 1.9 0 3.1-1.2 3.1-3.4v-.8h-.1c-.6.7-1.7 1.3-3.1 1.3-2.9 0-5.6-2.5-5.6-5.7s2.7-5.7 5.6-5.7c1.4 0 2.5.6 3.1 1.3h.1V4.6H43zm-2.1 5.1c0-2-1.3-3.5-3-3.5s-3.2 1.5-3.2 3.5 1.5 3.5 3.2 3.5 3-1.5 3-3.5z"/>
</svg>
Google Pay
</span>
</label>
<label class="payment-method" onclick="selectPayment('eft')">
<input type="radio" name="payment" value="eft">
<span>üè¶ EFT / Bank Transfer</span>
</label>
</div>
</div>

<button class="btn btn-primary btn-full" onclick="processOrder()" id="submitBtn" disabled>
Complete Order ‚Üí
</button>
</div>

<div id="processingScreen" style="display:none">
<div class="card" style="text-align:center">
<div class="spinner"></div>
<h2>Processing Payment...</h2>
<p style="color:var(--tl)">Please wait while we securely process your payment</p>
</div>
</div>

<div id="successScreen" style="display:none">
<div class="card" style="text-align:center">
<div class="success-icon">‚úì</div>
<h2 style="color:var(--success)">Payment Successful!</h2>
<p style="font-size:1.1rem;margin:1rem 0">Thank you for your order</p>
<p style="color:var(--tl)">Order #<span id="orderNumber"></span></p>
<div style="background:var(--bgl);padding:2rem;border-radius:12px;margin:2rem 0;text-align:left">
<h3 style="margin-bottom:1rem">What's Next?</h3>
<p style="margin:.5rem 0">üìß <strong>Confirmation Email</strong><br><small style="color:var(--tl)">Receipt and order details sent</small></p>
<p style="margin:.5rem 0">‚è±Ô∏è <strong>Processing Time</strong><br><small style="color:var(--tl)">Report ready in 24-48 hours</small></p>
<p style="margin:.5rem 0">üìä <strong>Report Delivery</strong><br><small style="color:var(--tl)">Emailed when complete</small></p>
</div>
<div style="display:flex;gap:1rem;justify-content:center;flex-wrap:wrap">
<a href="https://vetstay.click/index-ecommerce.html" class="btn btn-secondary">‚Üê Back to Home</a>
<a href="https://vetstay.click/index-ecommerce.html" class="btn btn-primary">Order Another</a>
</div>
</div>
</div>

</div>

<script>
let cart=JSON.parse(localStorage.getItem('vettedstay_cart')||'[]');
let selectedPayment='';

function loadOrder(){
const params=new URLSearchParams(window.location.search);
const items=params.get('items');
if(!items&&cart.length===0){
window.location.href='index-ecommerce.html';
return;
}
displayOrder();
}

function displayOrder(){
const container=document.getElementById('orderItems');
let subtotal=0;
container.innerHTML=cart.map(item=>{
subtotal+=item.price;
return`<div style="padding:1rem;background:var(--bgl);border-radius:8px;margin-bottom:1rem">
<strong>${item.name}</strong><br>
<small style="color:var(--tl)">${item.id}</small>
<div style="float:right;font-weight:700;color:var(--p)">R${item.price}</div>
</div>`;
}).join('');
document.getElementById('subtotal').textContent=`R${subtotal}`;
document.getElementById('total').textContent=`R${subtotal+15}`;
}

function selectPayment(method){
selectedPayment=method;
document.querySelectorAll('.payment-method').forEach(el=>el.classList.remove('selected'));
event.target.closest('.payment-method').classList.add('selected');
document.getElementById('submitBtn').disabled=false;
}

async function processOrder(){
const fullName=document.getElementById('fullName').value;
const idNumber=document.getElementById('idNumber').value;
const email=document.getElementById('email').value;
const phone=document.getElementById('phone').value;
const consent=document.getElementById('consent').checked;

if(!fullName||!idNumber||!email||!phone||!consent){
alert('Please fill all required fields');
return;
}

if(!selectedPayment){
alert('Please select a payment method');
return;
}

document.getElementById('checkoutForm').style.display='none';
document.getElementById('processingScreen').style.display='block';

// Simulate API call
const orderData={
items:cart,
customer:{fullName,idNumber,email,phone},
payment:{method:selectedPayment},
timestamp:new Date().toISOString()
};

// Call serverless API
try{
const response=await fetch('/api/orders',{
method:'POST',
headers:{'Content-Type':'application/json'},
body:JSON.stringify(orderData)
});
const result=await response.json();

setTimeout(()=>{
document.getElementById('processingScreen').style.display='none';
document.getElementById('successScreen').style.display='block';
document.getElementById('orderNumber').textContent=result.orderId||generateOrderId();
localStorage.removeItem('vettedstay_cart');
},2500);
}catch(err){
console.error('Order error:',err);
setTimeout(()=>{
document.getElementById('processingScreen').style.display='none';
document.getElementById('successScreen').style.display='block';
document.getElementById('orderNumber').textContent=generateOrderId();
localStorage.removeItem('vettedstay_cart');
},2500);
}
}

function generateOrderId(){
return`VS${Date.now()}${Math.random().toString(36).substr(2,5).toUpperCase()}`;
}

loadOrder();
</script>

</body>
</html>
